DPCalendar=window.DPCalendar||{},function(a,i,s){"use strict";s.requestCounter=0,s.modal=function(e,t,o,n){var r=new tingle.modal({footer:!1,stickyFooter:!1,closeMethods:["overlay","button","escape"],cssClass:["dpcalendar-modal"],closeLabel:i.JText._("COM_DPCALENDAR_CLOSE","Close"),onClose:function(){n&&n(r.modalBox.children[0].querySelector("iframe"))}});t&&a.body.clientWidth>t&&(isNaN(t)||(t+="px"),a.querySelector(".tingle-modal-box").style.width=t),isNaN(o)||(o+="px"),r.setContent('<iframe width="100%" height="'+o+'" src="'+e.toString()+'" frameborder="0" allowfullscreen></iframe>'),r.open()},s.print=function(e){a.body.outerHTML=a.querySelector(e).outerHTML,window.print(),setInterval(function(){window.location.reload(!1)},1e3)},s.slideToggle=function(e,t){if(e){if(!e.getAttribute("data-max-height")){var o=window.getComputedStyle(e),n=o.display,r=o.position,a=o.visibility,i=e.offsetHeight;if("none"===n){e.style.visibility="hidden",e.style.display="block",i=e.offsetHeight;var s=window.getComputedStyle(e);i+=parseFloat(s.getPropertyValue("margin-top"))+parseFloat(s.marginBottom),e.style.display=n,e.style.position=r,e.style.visibility=a}e.style.maxHeight&&e.style.maxHeight<i&&(i=e.style.maxHeight,e.style.overflowY="auto"),e.style.transition="max-height 0.5s ease-in-out",e.style.overflowX="hidden",e.style.overflowY="hidden",e.style.maxHeight="none"===n?"0px":i+"px",e.style.display="block",e.setAttribute("data-max-height",i+"px")}var l="0"===e.style.maxHeight.replace("px","").replace("%","");t&&e.addEventListener("transitionend",function(){t(l)},{once:!0}),setTimeout(function(){e.style.maxHeight=l?e.getAttribute("data-max-height"):"0"},1)}},s.encode=function(e){return e.replace(/&amp;/g,"&")},s.pad=function(e,t){for(var o=e+"";o.length<t;)o="0"+o;return o},s.isLocalStorageSupported=function(){var e="test";try{return localStorage.setItem(e,"1"),localStorage.removeItem(e),!0}catch(e){return!1}},s.formToQueryString=function(e,t){for(var o,n=t?e.querySelectorAll(t):e.elements,r=[],a=0;a<n.length;a++)if((o=n[a]).name&&!o.disabled&&"file"!=o.type&&"reset"!=o.type&&"submit"!=o.type&&"button"!=o.type)if("select-multiple"==o.type)for(var i=n[a].options.length-1;0<=i;i--)o.options[i].selected&&(r[r.length]=encodeURIComponent(o.name)+"="+encodeURIComponent(o.options[i].value));else("checkbox"!=o.type&&"radio"!=o.type||o.checked)&&(r[r.length]=encodeURIComponent(o.name)+"="+encodeURIComponent(o.value));return r.join("&").replace(/%20/g,"+")},s.arrayToQueryString=function(e,t){var o,n=[];for(o in e)if(e.hasOwnProperty(o)){var r=t?t+"["+o+"]":o,a=e[o];n.push(null!==a&&"object"==typeof a?s.arrayToQueryString(a,r):encodeURIComponent(r)+"="+encodeURIComponent(a))}return n.join("&").replace(/%20/g,"+")},s.currentLocation=function(o){return!!navigator.geolocation&&(navigator.geolocation.getCurrentPosition(function(e){var t="location.loc";-1==window.location.href.indexOf("administrator")&&(t="locationform.loc"),s.request("task="+t+"&loc="+encodeURIComponent(e.coords.latitude+","+e.coords.longitude),function(e){o(e.data.formated)})},function(e){i.renderMessages({error:[e.message]})}),!0)},s.request=function(o,n,e,t){var r=t?a.querySelector(".dp-loader"):null;r&&r.classList.remove("dp-loader_hidden"),e=e||"",e+=(e?"&":"")+i.getOptions("csrf.token")+"=1",s.requestCounter++,i.request({url:i.getOptions("system.paths").base+"/index.php?option=com_dpcalendar&"+o,method:"POST",data:e,onSuccess:function(e){s.requestCounter--,r&&r.classList.add("dp-loader_hidden");try{var t=JSON.parse(e);null!=t.messages&&0!==t.messages.length&&a.getElementById("system-message-container")&&i.renderMessages(t.messages),n&&n(t)}catch(e){a.getElementById("system-message-container")&&i.renderMessages({error:[o+"<br>"+e.message]})}},onError:function(e){s.requestCounter--,r&&r.classList.add("dp-loader_hidden");try{var t=JSON.parse(e);null!=t.messages&&0!==t.messages.length&&a.getElementById("system-message-container")&&i.renderMessages(t.messages)}catch(e){a.getElementById("system-message-container")&&i.renderMessages({error:[o+"<br>"+e.message]})}}})},s.debounce=function(n,r,a){var i;return null==r&&(r=500),null==a&&(a=!1),function(){var e=this,t=arguments,o=a&&!i;clearTimeout(i),i=setTimeout(function(){i=null,a||n.apply(e,t)},r),o&&n.apply(e,t)}},a.addEventListener("DOMContentLoaded",function(){[].slice.call(a.querySelectorAll(".dp-button-print")).forEach(function(e){e.addEventListener("click",function(){s.print(e.getAttribute("data-selector"))})}),[].slice.call(a.querySelectorAll(".dp-button-action[data-href]")).forEach(function(e){e.addEventListener("click",function(){return"new"==this.getAttribute("data-target")?window.open(this.getAttribute("data-href")):location.href=this.getAttribute("data-href"),!1})});var e=a.querySelector(".dp-timezone .dp-select");e&&("undefined"!=typeof Choices&&(e._choicejs=new Choices(e,{itemSelectText:"",noChoicesText:"",shouldSortItems:!1,shouldSort:!1,searchResultLimit:30})),e.addEventListener("change",function(){this.form.submit()})),s.isLocalStorageSupported()&&[].slice.call(a.querySelectorAll(".dp-tabs__input")).forEach(function(e){e.addEventListener("click",function(){localStorage.setItem("dp-tabs-"+this.name,this.id)}),localStorage.getItem("dp-tabs-"+e.name)==e.id&&(e.checked=!0)})})}(document,Joomla,DPCalendar);
