DPCalendar=window.DPCalendar||{},function(r,o){"use strict";r.addEventListener("DOMContentLoaded",function(){var t=r.querySelector(".com-dpcalendar-list");null==t&&(t=r.querySelector(".com-dpcalendar-blog")),null==t&&(t=r.querySelector(".com-dpcalendar-timeline"));var e,n=t.querySelector(".dp-input_location");o.autocomplete&&(o.autocomplete.create(n),n.addEventListener("dp-autocomplete-select",function(e){t.querySelector(".dp-form").submit()}),n.addEventListener("dp-autocomplete-change",function(e){var t="location.searchloc";-1==window.location.href.indexOf("administrator")&&(t="locationform.searchloc"),o.request("task="+t+"&loc="+encodeURIComponent(e.target.value.trim()),function(e){o.autocomplete.setItems(n,e.data)})})),o.Map&&n.getAttribute("data-latitude")&&n.getAttribute("data-longitude")&&o.Map.drawCircle(t.querySelector(".dp-map").dpmap,{latitude:n.getAttribute("data-latitude"),longitude:n.getAttribute("data-longitude")},t.querySelector(".dp-input[name=radius]").value,t.querySelector('.dp-input[name="length-type"]').value),[].slice.call(t.querySelectorAll(".dp-button-bar__actions .dp-button-search")).forEach(function(e){e.addEventListener("click",function(e){return e.preventDefault(),o.slideToggle(t.querySelector(".dp-form")),!1})}),[].slice.call(t.querySelectorAll(".dp-input, .dp-select")).forEach(function(t){t.addEventListener("change",function(e){"location"==t.name&&t.nextElementSibling||this.form.submit()})}),(e=t.querySelector(".dp-form .dp-button-search"))&&e.addEventListener("click",function(e){t.querySelector(".dp-form").submit()}),(e=t.querySelector(".dp-form .dp-button-clear"))&&e.addEventListener("click",function(e){return e.preventDefault(),[].slice.call(t.querySelectorAll('.dp-input:not([name="Itemid"])')).forEach(function(e){e.value=""}),t.querySelector("[name=radius]").value=20,t.querySelector("[name=length-type]").value="m",t.querySelector(".dp-form").submit(),!1}),(e=t.querySelector(".dp-form .dp-button-current-location"))&&(e.addEventListener("click",function(n){return n.preventDefault(),o.currentLocation(function(e){var t=n.target.closest(".dp-form");t.querySelector("[name=location]").value=e,t.submit()}),!1}),!1 in navigator&&(e.style.display="none"))})}(document,DPCalendar);
