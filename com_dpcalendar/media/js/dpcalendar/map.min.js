DPCalendar=window.DPCalendar||{},function(n,o,l){"use strict";l.Map={},l.Map.create=function(e){if("undefined"!=typeof L){e.classList.add("dp-map_loading");var a=e.dataset,d=L.map(e,{attributionControl:!0,fullscreenControl:!0,gestureHandling:!0,gestureHandlingOptions:{duration:2e3,text:{touch:o.JText._("COM_DPCALENDAR_LEAFLET_TEXT_TOUCH"),scroll:o.JText._("COM_DPCALENDAR_LEAFLET_TEXT_SCROLL"),scrollMac:o.JText._("COM_DPCALENDAR_LEAFLET_TEXT_SCROLLMAC")}}}).setView([a.latitude?a.latitude:47,a.longitude?a.longitude:4],a.zoom?a.zoom:4);if(d.attributionControl.setPrefix(""),d.attributionControl.addAttribution(o.getOptions("DPCalendar.map.tiles.attribution")),"google"==o.getOptions("DPCalendar.map.tiles.url")){var t=google.maps.MapTypeId.ROADMAP;switch(a.type){case 2:t=google.maps.MapTypeId.SATELLITE;break;case 3:t=google.maps.MapTypeId.HYBRID;break;case 4:t=google.maps.MapTypeId.TERRAIN}(p=L.gridLayer.googleMutant({type:t})).addTo(d),p.addEventListener("spawned",function(a){google.maps.event.addListenerOnce(a.mapObject,"idle",function(){e.classList.remove("dp-map_loading"),e.classList.add("dp-map_loaded")})})}else{var p;(p=L.tileLayer(o.getOptions("DPCalendar.map.tiles.url"),{id:"mapbox.streets"})).on("load",function(){e.classList.remove("dp-map_loading"),e.classList.add("dp-map_loaded")}),p.addTo(d)}d.dpMarkersCluster=L.markerClusterGroup(),d.addLayer(d.dpMarkersCluster),d.dpBounds=new L.latLngBounds,d.dpMarkers=[],(d.dpElement=e).dpmap=d;var r=n.createEvent("CustomEvent");return r.initCustomEvent("dp-map-loaded"),e.dispatchEvent(r),Array.isArray(e.dpCachedMarkers)&&(e.dpCachedMarkers.forEach(function(a){l.Map.createMarker(e,a.data,a.dragCallback)}),e.dpCachedMarkers=null),d}},l.Map.createMarker=function(a,e,d){var t=e.latitude,p=e.longitude;if(null!=t&&""!=t){if(null==a.dpmap)return null==a.dpCachedMarkers&&(a.dpCachedMarkers=[]),void a.dpCachedMarkers.push({data:e,dragCallback:d});e.color||(e.color="000000");var r={draggable:null!=d};r.icon=L.divIcon({className:"dp-location-marker",html:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="#'+String(e.color).replace("#","")+'" d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"/></svg>',iconSize:[25,30],iconAnchor:[10,35]});var n=L.marker([t,p],r),o=e.description?e.description:e.title;if(o){var l=n.bindPopup(o);n.on("click",function(){l.openPopup()})}return d&&n.on("dragend",function(a){d(a.target.getLatLng().lat,a.target.getLatLng().lng)}),a.dpmap.dpMarkersCluster.addLayer(n),a.dpmap.dpMarkers.push(n),a.dpmap.dpBounds.extend(n.getLatLng()),a.dpmap.panTo(a.dpmap.dpBounds.getCenter()),n}},l.Map.clearMarkers=function(a){if(null!=a&&null!=a.dpmap&&null!=a.dpmap.dpMarkers){for(var e=0;e<a.dpmap.dpMarkers.length;e++)a.dpmap.removeLayer(a.dpmap.dpMarkers[e]);a.dpmap.dpMarkers=[],a.dpmap.dpBounds=new L.latLngBounds;var d=a.dpmap.dpElement.dataset;a.dpmap.panTo([d.latitude?d.latitude:47,d.longitude?d.longitude:4])}},l.Map.moveMarker=function(a,e,d,t){e&&null!=a.dpmap&&(e.setLatLng([d,t]),a.dpmap.dpBounds=new L.latLngBounds,a.dpmap.dpMarkers.forEach(function(){a.dpmap.dpBounds.extend(e.getLatLng())}),a.dpmap.panTo(a.dpmap.dpBounds.getCenter()))},l.Map.drawCircle=function(a,e,d,t){null!=a.dpmap&&("mile"==t&&(d*=1.60934),a.dpmap.dpMarkers.push(L.circle([e.latitude,e.longitude],1e3*d).addTo(a.dpmap)),a.dpmap.dpMarkers.push(L.circleMarker([e.latitude,e.longitude],{radius:10,color:"#000000",fillColor:"#000000",fillOpacity:1}).addTo(a.dpmap)),a.dpmap.panTo([e.latitude,e.longitude]))}}(document,Joomla,DPCalendar);
