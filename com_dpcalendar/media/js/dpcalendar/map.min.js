DPCalendar=window.DPCalendar||{},function(a,t,p){"use strict";p.Map={},p.Map.create=function(e){if("undefined"!=typeof L){var a=e.dataset,r=L.map(e,{attributionControl:!0,fullscreenControl:!0,gestureHandling:!0,gestureHandlingOptions:{duration:2e3,text:{touch:t.JText._("COM_DPCALENDAR_LEAFLET_TEXT_TOUCH"),scroll:t.JText._("COM_DPCALENDAR_LEAFLET_TEXT_SCROLL"),scrollMac:t.JText._("COM_DPCALENDAR_LEAFLET_TEXT_SCROLLMAC")}}}).setView([a.latitude?a.latitude:47,a.longitude?a.longitude:4],a.zoom?a.zoom:4);if(r.attributionControl.setPrefix(""),r.attributionControl.addAttribution(t.getOptions("DPCalendar.map.tiles.attribution")),"google"==t.getOptions("DPCalendar.map.tiles.url")){var d=google.maps.MapTypeId.ROADMAP;switch(a.type){case 2:d=google.maps.MapTypeId.SATELLITE;break;case 3:d=google.maps.MapTypeId.HYBRID;break;case 4:d=google.maps.MapTypeId.TERRAIN}L.gridLayer.googleMutant({type:d}).addTo(r)}else L.tileLayer(t.getOptions("DPCalendar.map.tiles.url"),{id:"mapbox.streets"}).addTo(r);return r.dpMarkersCluster=L.markerClusterGroup(),r.addLayer(r.dpMarkersCluster),r.dpBounds=new L.latLngBounds,r.dpMarkers=[],(r.dpElement=e).dpmap=r,Array.isArray(e.dpCachedMarkers)&&(e.dpCachedMarkers.forEach(function(a){p.Map.createMarker(e,a.data,a.dragCallback)}),e.dpCachedMarkers=null),r}},p.Map.createMarker=function(a,e,r){var d=e.latitude,t=e.longitude;if(null!=d&&""!=d){if(null==a.dpmap)return null==a.dpCachedMarkers&&(a.dpCachedMarkers=[]),void a.dpCachedMarkers.push({data:e,dragCallback:r});e.color||(e.color="000000");var p={draggable:null!=r};p.icon=L.divIcon({className:"dp-location-marker",html:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="#'+String(e.color).replace("#","")+'" d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"/></svg>',iconSize:[25,30],iconAnchor:[10,35]});var n=L.marker([d,t],p),o=e.description?e.description:e.title;if(o){var l=n.bindPopup(o);n.on("click",function(){l.openPopup()})}return r&&n.on("dragend",function(a){r(a.target.getLatLng().lat,a.target.getLatLng().lng)}),a.dpmap.dpMarkersCluster.addLayer(n),a.dpmap.dpMarkers.push(n),a.dpmap.dpBounds.extend(n.getLatLng()),a.dpmap.panTo(a.dpmap.dpBounds.getCenter()),n}},p.Map.clearMarkers=function(a){if(null!=a&&null!=a.dpmap&&null!=a.dpmap.dpMarkers){for(var e=0;e<a.dpmap.dpMarkers.length;e++)a.dpmap.removeLayer(a.dpmap.dpMarkers[e]);a.dpmap.dpMarkers=[],a.dpmap.dpBounds=new L.latLngBounds;var r=a.dpmap.dpElement.dataset;a.dpmap.panTo([r.latitude?r.latitude:47,r.longitude?r.longitude:4])}},p.Map.moveMarker=function(a,e,r,d){e&&null!=a.dpmap&&(e.setLatLng([r,d]),a.dpmap.dpBounds=new L.latLngBounds,a.dpmap.dpMarkers.forEach(function(){a.dpmap.dpBounds.extend(e.getLatLng())}),a.dpmap.panTo(a.dpmap.dpBounds.getCenter()))},p.Map.drawCircle=function(a,e,r,d){null!=a.dpmap&&("mile"==d&&(r*=1.60934),a.dpmap.dpMarkers.push(L.circle([e.latitude,e.longitude],1e3*r).addTo(a.dpmap)),a.dpmap.dpMarkers.push(L.circleMarker([e.latitude,e.longitude],{radius:10,color:"#000000",fillColor:"#000000",fillOpacity:1}).addTo(a.dpmap)),a.dpmap.panTo([e.latitude,e.longitude]))}}(document,Joomla,DPCalendar);
