DPCalendar=window.DPCalendar||{},function(o,r){"use strict";o.addEventListener("DOMContentLoaded",function(){var t=o.querySelector(".com-dpcalendar-list");null==t&&(t=o.querySelector(".com-dpcalendar-blog")),null==t&&(t=o.querySelector(".com-dpcalendar-timeline"));var e,n=t.querySelector(".dp-input_location");r.autocomplete&&(r.autocomplete.create(n),n.addEventListener("dp-autocomplete-select",function(e){t.querySelector(".dp-form:not(.dp-timezone)").submit()}),n.addEventListener("dp-autocomplete-change",function(e){var t="location.searchloc";-1==window.location.href.indexOf("administrator")&&(t="locationform.searchloc"),r.request("task="+t+"&loc="+encodeURIComponent(e.target.value.trim()),function(e){r.autocomplete.setItems(n,e.data)})})),r.Map&&n.getAttribute("data-latitude")&&n.getAttribute("data-longitude")&&r.Map.drawCircle(t.querySelector(".dp-map").dpmap,{latitude:n.getAttribute("data-latitude"),longitude:n.getAttribute("data-longitude")},t.querySelector(".dp-input[name=radius]").value,t.querySelector('.dp-input[name="length-type"]').value),[].slice.call(t.querySelectorAll(".dp-button-bar__actions .dp-button-search")).forEach(function(e){e.addEventListener("click",function(e){return e.preventDefault(),r.slideToggle(t.querySelector(".dp-form:not(.dp-timezone)")),!1})}),[].slice.call(t.querySelectorAll(".dp-input, .dp-select")).forEach(function(t){t.addEventListener("change",function(e){"location"==t.name&&t.nextElementSibling||this.form.submit()})}),(e=t.querySelector(".dp-form:not(.dp-timezone) .dp-button-search"))&&e.addEventListener("click",function(e){t.querySelector(".dp-form:not(.dp-timezone)").submit()}),(e=t.querySelector(".dp-form:not(.dp-timezone) .dp-button-clear"))&&e.addEventListener("click",function(e){return e.preventDefault(),[].slice.call(t.querySelectorAll('.dp-input:not([name="Itemid"])')).forEach(function(e){e.value=""}),t.querySelector("[name=radius]").value=20,t.querySelector("[name=length-type]").value="m",t.querySelector(".dp-form:not(.dp-timezone)").submit(),!1}),(e=t.querySelector(".dp-form:not(.dp-timezone) .dp-button-current-location"))&&(e.addEventListener("click",function(n){return n.preventDefault(),r.currentLocation(function(e){var t=n.target.closest(".dp-form:not(.dp-timezone)");t.querySelector("[name=location]").value=e,t.submit()}),!1}),!1 in navigator&&(e.style.display="none"))})}(document,DPCalendar);
